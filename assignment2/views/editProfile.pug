extends layout

block content
  .container
    form(action='/profile/edit' method="POST")
      .col-2of5.bg-white.profile
        .relative.img-edit
          img.avatar(src=user.avatarUrl alt="avatar")
          img.avatar-upload(src="/img/upload.png" alt="upload-img")
        input.input-profile(type="text" value=user.name name="name" placeholder="Full name")
        h5=`@${user.username}`
        input.input-profile(type="text" value=user.location name="location" placeholder="Location")
        textarea.input-profile(placeholder="Personal description" name="bio")=user.bio
        button.btn-primary.space-top Save
        a.btn-border.space-top(href="/profile") Cancel
    include tweet
block script
    script(src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js")
    script.
        const options = {
            onUploadDone: file => {
                console.log('file: ', file)
                const url = file.filesUploaded[0].url
                console.log(url)
                $.ajax({
                        url: '/profile/avatar',
                        type: 'POST',
                        data: { avatarUrl: url },
                        success(res) {
                        if (res.success) location.href='/profile';
                    }
                });
            }
        };
        $('.avatar-upload').click(function() {
            const apikey = 'AP2lqu4mSQwCZfEMEfPG6z';
            const client = filestack.init(apikey);

            client.picker(options).open();
        });
